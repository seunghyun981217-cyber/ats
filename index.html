<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<title>ATS 스마트맵</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
body{margin:0;display:flex;height:100vh;font-family:system-ui,sans-serif}
.panel{width:360px;border-right:1px solid #ddd;padding:12px;overflow-y:auto}
#map{flex:1}
.result{padding:6px;border-bottom:1px dashed #ddd;cursor:pointer}
.result:hover{background:#eef2ff}
</style>
</head>

<body>

<div class="panel">
  <h3>ATS 스마트맵</h3>

  <select id="district">
    <option value="ALL">전체 구</option>
  </select><br><br>

  <select id="type">
    <option value="ALL">전체 유형</option>
  </select>

  <h4>결과 목록</h4>
  <div id="list">조건을 선택하세요</div>
</div>

<div id="map"></div>

<script>
const PLACES = [
  {
    name:"송파구립장애인복지관",
    district:"송파구",
    type:"휠체어 대여소",
    lat:37.4958,
    lng:127.1234,
    description:"무료 휠체어 대여 가능"
  },
  {
    name:"강동구청 충전소",
    district:"강동구",
    type:"전동휠체어 충전소",
    lat:37.5301,
    lng:127.1238,
    description:"1층 민원실 앞"
  }
];

let map, markers=[], info;

function initMap(){
  map=new google.maps.Map(document.getElementById("map"),{
    center:{lat:37.51,lng:127.1},zoom:12
  });
  info=new google.maps.InfoWindow();
  initFilter();
  createMarkers();
  filter();
}

function initFilter(){
  const dSel=document.getElementById("district");
  const tSel=document.getElementById("type");
  [...new Set(PLACES.map(p=>p.district))].forEach(d=>{
    dSel.innerHTML+=`<option>${d}</option>`;
  });
  [...new Set(PLACES.map(p=>p.type))].forEach(t=>{
    tSel.innerHTML+=`<option>${t}</option>`;
  });
  dSel.onchange=tSel.onchange=filter;
}

function createMarkers(){
  PLACES.forEach(p=>{
    const m=new google.maps.Marker({
      position:{lat:p.lat,lng:p.lng},map
    });
    m.place=p;
    m.addListener("click",()=>show(m));
    markers.push(m);
  });
}

function show(m){
  const p=m.place;
  info.setContent(`<b>${p.name}</b><br>${p.district} · ${p.type}<br>${p.description}`);
  info.open(map,m);
}

function filter(){
  const d=document.getElementById("district").value;
  const t=document.getElementById("type").value;
  const list=document.getElementById("list");
  list.innerHTML="";
  markers.forEach(m=>{
    const p=m.place;
    const ok=(d==="ALL"||p.district===d)&&(t==="ALL"||p.type===t);
    m.setVisible(ok);
    if(ok){
      const div=document.createElement("div");
      div.className="result";
      div.innerText=p.name;
      div.onclick=()=>{
        map.panTo({lat:p.lat,lng:p.lng});
        map.setZoom(15);
        show(m);
      };
      list.appendChild(div);
    }
  });
  if(!list.innerHTML) list.innerText="결과 없음";
}
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBRFrDGLMi8UZgAoDITyJu694vKXdTglbU&callback=initMap" async defer></script>
</body>
</html>

